<!DOCTYPE html>
<html lang="en">
<head>
    <title>idk calculator</title>


    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" 
    crossorigin="anonymous">

    <style>
        
    body {
        background-image: linear-gradient(to right,rgb(9, 255, 255), blue);
        background-repeat: no-repeat;
        background-attachment: fixed;
        
    }


    #enemyHP{
        width: 100%;
        background-color: lightgreen;
    }

    #myHP{
        width: 100%;
        background-color: lightgreen;
    }

    .progress{
        background-color: red;
    }

    #myDiv {
        height: 500px;
    }


    #attackButton {
        position: relative;
        bottom: 170px;
    }

    #hitsplats p{
        margin: auto;
        display:flex;
        justify-content: center;
        align-items: center;
        width: 40px;
        height: 40px;
        background-image: url("hitsplat.png");
        background-repeat: no-repeat;
        background-size: 100%;
        position: relative;
        z-index: 1;

    }
    #hitsplats {
        visibility: hidden;
    }

    .hit1{
        position: relative;
        top: 70px;
        left: 2px;

    }
    .hit2{
        position: relative;
        right: 25px;
        top: 47px;


    }
    .hit3{
        position: relative;
        top: 25px;
        left: 2px;
    }

    #monster {
        height: 340px;
        width: 230px;
        background-image: url("verzik.png");
        background-repeat: no-repeat;
        background-size: 80%;
        position: relative;
        bottom: 260px;
        left: 30px;
        margin: auto;
        z-index: -1;
    }

    #player {
        background-image: url("scythehits/0002.png");
        background-size: 100%;
        height: 350px;
        width: 300px;
        background-repeat: no-repeat;
        position: relative;
        right: 260px;
        top: 15px;
        z-index: 3;
    }

    #hiddenImages{
        visibility: hidden;
        size:0px;
        height: 0px;
        width: 0px;
    };

    </style>

</head>
<body>
    <a href="Q4.html" style="font-size: large;">shopping list la</a>
    <br>
    <a href="Q2.html" style="font-size: large;">carousel example</a>
    <br>
    <a href="q3.html" style="font-size: large;">axios example</a>
    <br>
    <a href="calculator.html" style="font-size: large;">calculator javascript example</a>
    <br>
    <br>    
    <div id="myDiv" class="container-fluid">
        <div id="hiddenImages">
        </div>
        <p style="text-align: center; font-size:50px; z-index: 1; margin-bottom: 50px;" class="text-danger">There is 5t cooldown between each attack</p>
        <div class="row">
            <div class="col-4"></div>

            <div class="col-4">
                <div class="text-danger text-center" id="EHP">3250/3250</div>
                <div class="progress">
                    <div class="progress-bar progress-bar-success" id="enemyHP"></div>
                </div>

                <div id="hitsplats" class="text-info"><p>0</p><p>0</p><p>0</p></div>
                <div id="monster"></div>
            </div>




            <div class="col-4">
                <div id="player"></div>
            </div>

            <div class="col-1"></div>
        </div>

        <br>

        <div class="row">
            <div class="btn btn-danger w-50 mx-auto" id="attackButton">attack</div>
        </div>


    </div>
    <br>

    <p style="height: 200px;"></p>



    <script>


    var hiddenImagesElement = document.getElementById("hiddenImages"); 
    for (i=1; i<=11; i++){
        var frameNumber = i*2;
        if (frameNumber < 10){
            frameNumber = "0" + frameNumber;
        }
        var imgString = "<img src='scythehits/00" + frameNumber + ".png'>";
        hiddenImagesElement.innerHTML += imgString;


    }

        var cd = false;

        function getRndInteger(min, max) {
            return Math.floor(Math.random() * (max - min + 1) ) + min;
        }

        var attackElement = document.getElementById("attackButton");
        attackElement.addEventListener("click", attackFunction);

        function myTimeout(timeSleep, frameNumber, playerElement){
        setTimeout(function(){
            playerElement.style.backgroundImage = "url('scythehits/00" + frameNumber + ".png')";
            }, timeSleep);
        }

        function attackFunction(){

            if (cd){
                return;
            }

            cd = true;
            console.log("attack!!");
            var ehpBarElement = document.getElementById("enemyHP");
            var eHPElement = document.getElementById("EHP");

            var eHPString = eHPElement.innerHTML;
            var currentEHP = eHPString.split("/")[0];
            var maxEHP = eHPString.split("/")[1];

            console.log(currentEHP);
            console.log(maxEHP);

            var hit1 = getRndInteger(0,46);
            var hit2 = getRndInteger(0,23);
            var hit3 = getRndInteger(0,11);

            currentEHP -= hit1 + hit2 + hit3;

            if (currentEHP <= 0){
                currentEHP = 0;
            }

           

            var eHPPercent = ((currentEHP / maxEHP)*100).toFixed(0);
            

            var hitsplatsElement = document.getElementById("hitsplats");
            hitsplatsElement.innerHTML = "<p class='hit1'>" + hit1 + "</p>" + "<p class='hit2'>" + hit2 + "</p>" + "<p class='hit3'>" + hit3 + "</p>";
            
            console.log("change attack");
            var playerElement = document.getElementById("player");
            for (i=1; i<=11; i++){
                var frameNumber = i*2;
                if (frameNumber < 10){
                    frameNumber = "0" + frameNumber;
                }
                //console.log("url('scythehits/00" + frameNumber + ".png')")
                myTimeout(150*i, frameNumber, playerElement);




            }
            //document.getElementById("player").style.backgroundImage = 'url("attack.gif")';
            
            setTimeout(function(){
            document.getElementById("hitsplats").style.visibility = "visible";
            ehpBarElement.style.width = eHPPercent + "%";
            eHPElement.innerHTML = currentEHP + "/" + maxEHP;
        }, 800);
            

            setTimeout(function(){
                document.getElementById("player").style.backgroundImage = 'url("scythehits/0002.png")';
            },1500);
            
            setTimeout(function(){cd = false;}, 3000);
            
            setTimeout(function(){
            document.getElementById("hitsplats").style.visibility = "hidden";}, 2000);
            
        }
    </script>

    
</body>
</html>